---
layout: post
title: Rotational dynamics in neural population
date: 2025-08-16 18:30:16
description: introduce neural latent dynanics from jPCA 
tags: latent-dynamics, neural-population, dimensionality-reduction
categories: latent-dynamics
featured: true
related_posts: true
related_publications: true
citation: true
math: true
toc:
  beginning: true
  sidebar: left
---

Many years later, when I reflect back on the first quarter of the 21st century studies on computational neuroscience and  brain-computer interface (BCI), among papers on fancy Neural Network based decoders and clinical breakthroughs expanding from cursor and motor BCI to speech and vision, I might still recollect a distant afternoon when I first heard the name Mark Churchland, and more specifically, neural population dynamics and jPCA. I perhaps first read the paper {% cite jpca %} at least a decade after it came out, but the astonishing finding and the elegance of the algorithm, together with its implicit influences on shaping my thoughts of neural populations made it a classic enduring the test of time. This post is both an exploration and a summary, where I will extract a few key components from the article {% cite jpca %}, specifically its dynamical systems interpretation and then summarize the jPCA algorithm. 

## Dynamical Systems Perspective
A traditional perspective characeterizes neural activities from the primary motor cortex (M1) as representing the corresponding movement parameters. Equivalently, we could write out a parametric equation:

$$
r_n(t) = f_n(param_{1}(t), param_{2}(t), param_{3}(t), ...) 
$$

where $r_n(t)$ is the firing rate for the nth neuron, tuned by the corresponding function $f_n$. Alternatively, instead of a representational model, another perspective based on neural population encoding which reflect behavior parameters not on the single neuron level, but on the population level, is written as follows, which characterize a __dynamical system__ perspective. Or put differently, within a dynamical system model, each single unit response should reflect the "dynamical factors" exhibited from each latent state in the latent space. 

$$
\dot{r}(t) = f(r(t)) + u(t)
$$

In this view, the dynamics, i.e., the evolution of population response encodes the movement parameters. Here u(t) is an unknown external input. 

## Quasi-rthymic Responses 
As made clear in the article, the critical finding of this study is that reaching, a non-oscillatory movement (unlike the swimming leech or a walking monkey), leads to a quasi-oscillatory neural trajectory. More surprisingly, the rotations are distinct not by reaching curvatures but determined from the initial conditions, which are encoded by the __preparatory activities__. We will see that __preparatory activities__ feature as an essential ingredient in Churchland and colleagues' research, resulting in surpising analysis on nullspace/output-potent space later {% cite nullspace %}{% cite prep_review %}. Specifically, as the authors summarized, the trajectories have the following primary properties, which support the dynamical system perspective:

> 1] Rotation is a ubiquitous phenomenon during behavior;
>
> 2] Same directions for all rotations;
>
> 3] Preparatory activities determine the initial conditions, which govern trajectories;
>
> 4] Rotations do not directly correlate with the curvature;


<div class="row mt-3">
    <div class="col-sm mt-3 mt-md-0">
        {% include figure.liquid loading="eager" path="assets/img/jPCA/jPCA_fig_3.png" class="img-fluid rounded z-depth-1" zoomable=true %}
    </div>
</div>
<div class="caption">
    Adapted from Fig. 3 in {% cite jpca %}. jPCA projections into the first 2 dimensions of different monkeys. Each trajectory plots the first __200ms__ activities following the preparatory state (initial conditions). Colors correpond to projection onto jPC1. 
</div>

An interesting reflection is that with the dynamical system perspective hypothesis, then the rotations of neural states should be similar no matter what reaching condition: only the initial conditions determine the trajectories, with the underlying $f$ being identical. I found this line of thought extremely insightful, which demonstrates how important it is to deeply understand theory to deduce results, thought they might look unorthodox --- the neural states should be similar even when the reaches are in opposite directions. 

The authors also carried some control (shuffling) analyses, and corroborated that such rotational pattern does explain a significant amount of data variance. Interestingly, the authors also discovered that, although rotations are consistent for all conditions in the same jPCA plane (similar orietations and speeds), such rotations actually exist in multiple jPCA planes. As shown below, all top 3 jPCA planes contain rotatinos, but with higher-number jPCA planes carrying less ordered rotations with slower speed. Perhaps not so surprisingly, both PMd and M1 exhibit such rotational structures, with initial states/prepatory activities better distinguished in PMd (again not surpising, because PMd is known for movement planning and stronger preparatory activities. Eight years later, Russo et al. {% cite russo %} will exhibit an obvious distinction between how M1 and PMd encoders movement sequence/planning by exploring the latent trajectories, providing further analyses between these two brain regions)

<div class="row mt-3">
    <div class="col-sm mt-3 mt-md-0">
        {% include figure.liquid loading="eager" path="assets/img/jPCA/jPCA_supfig_4.png" class="img-fluid rounded z-depth-1" zoomable=true %}
    </div>
</div>
<div class="caption">
    Adapted from Supplementary Fig. 4 in {% cite jpca %}. jPCA projections into different planes exhibit similar rotation structures. 
</div>


## jPCA
Based on the dynamical systems perspective, since it's the time-dependent structure that we focus, a naive simple PCA is not sufficent to extract such temporal structures from neural activities, since PCA is not specificall designed for incapsulating dynamical structures. Here Churchland et al. developed an algorithm called jPCA to reoslve this issue. Specifically, it finds orthonormal axes (thus basis which define linear subspaces) which capture the strongest rotational components from subspace identified by PCA (to ensure that the rotational dynamics come from subspaces that efficiently "represent" the high dimensional neural space). Conseuqently, this is equivalent to rotating the PCA projections to help us "see" the rotation most clearly (as shown in video below). In the paper the authors chose the PCA dimension as 6, and the data projected from the 6-D PCA space to the first 2 jPCA components, thus a plane which captures the strongest rotations, is displayed to reveal the underlying oscillatory structure. 

<div class="row mt-3">
    <div class="col-sm mt-3 mt-md-0">
        {% include video.liquid path="assets/video/jPCA/jPCA_Supp_Video_2.mp4" class="img-fluid rounded z-depth-1" controls=true autoplay=true %}
    </div>
</div>
<div class="caption">
    Adapted from Supplementary Movie 2 in {% cite jpca %}, showing jPCA projections are essentially a different view of PCA projections. 
</div>

The core of jPCA lies in the following steps:

> 1] Fit a linear dynamical system for $\dot{X}_{red} = M_{skew}X_{red}$, where $X_{red}$ is of size $6 \times ct$, c: conditions, t: time. $dot{X}_{red}$ is of size $6 \times c(t-1)$ (use discrete time difference as approximations for differential). Notice that to be precise, $X_{red}$ is also truncated to be $6 \times c(t-1)$. 6 is the dimensionlality of a PCA projection before starting jPCA, as mentioned above. 
>
> 2] 



## Discussions
The extracted neural trajectory is only "quasi-oscillatory", and usually exists for barely 1 cycle. 

For many neurons, the preparatory and movement-related single neuron responses do exhibit some quasi-oscillations which last for about 1 cycle (See in below).

<div class="row mt-3">
    <div class="col-sm mt-3 mt-md-0">
        {% include figure.liquid loading="eager" path="assets/img/jPCA/jPCA_fig_2.png" class="img-fluid rounded z-depth-1" zoomable=true %}
    </div>
</div>
<div class="caption">
    Adapted from Fig. 2 in {% cite jpca %}. Trace colors are according to the strengthof preparatory activities (red with greatest preparotory response). It allows clear view of the evolution of preparatory patterns during the movement. 
</div>

Not sure yet if this explains the observed rotation structure at the population level. However, the population level state-space rotations direcly to neural responses at single unit level: notice that each axis of jPCA exhibits similar patterns as single-neuron response(shown below)

<div class="row mt-3">
    <div class="col-sm mt-3 mt-md-0">
        {% include figure.liquid loading="eager" path="assets/img/jPCA/jPCA_supfig_1.png" class="img-fluid rounded z-depth-1" zoomable=true %}
    </div>
</div>
<div class="caption">
    Adapted from Supplementary Fig. 1 in {% cite jpca %}. The projections onto jPC's are similar to single neuron response. 
</div>

As Churchland et al argued, this could be explained by the fact that jPC's capture the most conscipuous patterns in the data, and each jPCA projection is a weighted sum/average of individual-neuron resopnses. Likewise, each single neuron could also be interpreted as a combination of all the jPC projected patterns, except that the intertwined relationship is not obvious if just viewed from a single neuron or a pattern itself. 

We might argue that perhaps a sufficient condition for the rotation structures is that neurons exhibit multiphasic responses. However, this turns out to be not necessarily true. The authors also tested on a "complex-kinematic model" and recorded EMG. Though both carry multi-phasic reponses, they do not show clear rotation patterns. In the end, as the authors argued, multiphasic responses are not enough: we also need the multi-phasic patterns to have consistent phases for around 90 degrees apart. 

More exploration on the 90 degrees phase difference here: 

Another core question is how such rotational pattern generates non-oscilatory movement patterns, e.g. reaching. The authors conducted some further simulation analyses and demonstrated that it's possible to reconstruct EMG (deltoid) activities from weighted sum of rotations with different magnitude and phases (they call this the generator-model). It's interesting to see this because EMG does not acquire the latent rotational patterns, yet it could be reconstructed from rotational dynamics. Further quantification analyses also showed that only the neural data and generator-model exhibit rotational patterns, whereas two other models (velocity-tuned, complex-kinematic models (not explained here in this blog)) do not. Since EMG showed only weak rotation, as the authors put, this further illustrates that the latent rotation dynamics do not necessarily result from a muli-phasic reponse, but how such response is constructed. 

One interesting finding is that the speed of movements is not encoded as the speed of the latent trajectories (they keep similar angular velocity). The amplitude of rotation dictates different movement speeds (for example faster or slower reaches). As Churchland et al. argued, this could be nicely explained since rotations with larger amplitude represent more strongly multi-phasic responses, with which EMG frequently entails larger accelerataions. 

## Conclusions
In summary, 

> 1] "state-space rotations produce briefly oscillatory temporal patterns that provide an effective basis for producing multiphasic muscle activity, suggesting that non-periodic movements may be generated via neural mechanisms resembling those that generate rhythmic movement";
> 
> 2] Preparactory encoders the initial conditions for the underlying dynamical system;

The shift of views from single neuron analysis in pursuit of movement/behavior correlates/representaitons, to a dynamical system analysis on population level, is becoming an increasingly populat domain. As we will see later, the other side of the same story, geometry instead of dynamics, will quickly come into the arena under the name of neural manifold. This, with both aboundance of aesthetic elegance and disatisfying lack of mathematical rigor from either topology or differential geometry, will be an eternal theme for the following research, projects, and blogs of mine. 


## Open Questions
The annotomical circuitry that leads to the dynamical system/latent trajectory is still unclear. 

What happens after the 200ms? As shown in Supp Movie 3 below, how would the observed rotations evolve later in time (notice that all the rotations exist for merely 1~1.5 cylces)

<div class="row mt-3">
    <div class="col-sm mt-3 mt-md-0">
        {% include video.liquid path="assets/video/jPCA/jPCA_Supp_Video_3.mp4" class="img-fluid rounded z-depth-1" controls=true autoplay=true %}
    </div>
</div>
<div class="caption">
    Adapted from Supplementary Movie 3 in {% cite jpca %}, showing the evolution of the projected states. 
</div>

Although in the Discussions section, I briefly talked about the reason for existence of the rotational structures, The problem remains as to how individual oscillations of different phases and amplitudes would result in a consistent rotation. 

At the algorithmic level, the jPCA method stems from dissecting the rotation component away from the general linear transformation. Can this be further stripped away from PCA? 

Churchland argued that the dynamics quantified by a skew-symmetric matrix hints at the underlying functionally antisymmetric connectivity. The authors wrote: "a given neural dimension (for example, $jPC_1$) positively influences another (for example, $jPC_2$), which negatively influences the first. However, it is unclear whether this population-level pattern idrectly reflects a circuit-level dominance of antisymmetric connectivity" 


