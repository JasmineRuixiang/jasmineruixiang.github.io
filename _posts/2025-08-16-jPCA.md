---
layout: post
title: Rotational dynamics in neural population
date: 2025-08-16 18:30:16
description: introduce neural latent dynanics from jPCA 
tags: latent-dynamics, neural-population, dimensionality-reduction
categories: latent-dynamics
featured: true
related_posts: true
related_publications: true
citation: true
math: true
toc:
  beginning: true
  sidebar: left
---

Many years later, when I reflect back on the first quarter of the 21st century studies on computational neuroscience and  brain-computer interface (BCI), among papers on fancy Neural Network based decoders and clinical breakthroughs expanding from cursor and motor BCI to speech and vision, I might still recollect a distant afternoon when I first heard the name Mark Churchland, and more specifically, neural population dynamics and jPCA. I perhaps first read the paper {% cite jpca %} at least a decade after it came out, but the astonishing finding and the elegance of the algorithm, together with its implicit influences on shaping my thoughts of neural populations made it a classic enduring the test of time. This post is both an exploration and a summary, where I will extract a few key components from the article {% cite jpca %}, specifically its dynamical systems interpretation and then summarize the jPCA algorithm. 

## Dynamical Systems Perspective
A traditional perspective characeterizes neural activities from the primary motor cortex (M1) as representing the corresponding movement parameters. Equivalently, we could write out a parametric equation:

$$
r_n(t) = f_n(param_{1}(t), param_{2}(t), param_{3}(t), ...) 
$$

where $r_n(t)$ is the firing rate for the nth neuron, tuned by the corresponding function $f_n$. Alternatively, another perspective based on neural population encoding which reflect behavior parameters not on the single neuron level, but on the population level, is written as follows, which characterize a __dynamical system__ perspective:

$$
\dot{r}(t) = f(r(t)) + u(t)
$$

In this view, the dynamics, i.e., the evolution of population response encodes the movement parameters. Here u(t) is an unknown external input. 

## Quasi-rthymic Responses 
As made clear in the article, the critical finding of this study is that reaching, a non-oscillatory movement (unlike the swimming leech or a walking monkey), leads to a quasi-oscillatory neural trajectory. More surprisingly, the rotations are distinct not by reaching curvatures but determined from the initial conditions, which are encoded by the __preparatory activities__. We will see that __preparatory activities__ feature as an essential ingredient in Churchland and colleagues' research, resulting in surpising analysis on nullspace/output-potent space later {% cite nullspace %}{% cite prep_review %}. Specifically, as the authors summarized, the trajectories have the following primary properties, which support the dynamical system perspective:

> 1] Rotation is a ubiquitous phenomenon during behavior;
>
> 2] Same directions for all rotations;
>
> 3] Preparatory activities determine the initial conditions, which govern trajectories;
>
> 4] Rotations do not directly correlate with the curvature;


<div class="row mt-3">
    <div class="col-sm mt-3 mt-md-0">
        {% include figure.liquid loading="eager" path="assets/img/jPCA/jPCA_fig_3.png" class="img-fluid rounded z-depth-1" zoomable=true %}
    </div>
</div>
<div class="caption">
    Adapted from Fig. 3 in {% cite jpca %}. jPCA projections into the first 2 dimensions of different monkeys. Each trajectory plots the first __200ms__ activities following the preparatory state (initial conditions). Colors correpond to projection onto jPC1. 
</div>

An interesting reflection is that with the dynamical system perspective hypothesis, then the rotations of neural states should be similar no matter what reaching condition: only the initial conditions determine the trajectories, with the underlying $f$ being identical. I found this line of thought extremely insightful, which demonstrates how important it is to deeply understand theory to deduce results, thought they might look unorthodox --- the neural states should be similar even when the reaches are in opposite directions. 

The authors also carried some control (shuffling) analyses, and corroborated that such rotational pattern does explain a significant amount of data variance. Interestingly, the authors also discovered that, although rotations are consistent for all conditions in the same jPCA plane (similar orietations and speeds), such rotations actually exist in multiple jPCA planes. As shown below, all top 3 jPCA planes contain rotatinos, but with higher-number jPCA planes carrying less ordered rotations with slower speed. Perhaps not so surprisingly, both PMd and M1 exhibit such rotational structures, with initial states/prepatory activities better distinguished in PMd (again not surpising, because PMd is known for movement planning and stronger preparatory activities. years later, Russo studies )

<div class="row mt-3">
    <div class="col-sm mt-3 mt-md-0">
        {% include figure.liquid loading="eager" path="assets/img/jPCA/jPCA_supfig_4.png" class="img-fluid rounded z-depth-1" zoomable=true %}
    </div>
</div>
<div class="caption">
    Adapted from Supplementary Fig. 4 in {% cite jpca %}. jPCA projections into different planes exhibit similar rotation structures. 
</div>


## jPCA
Based on the dynamical systems perspective, since it's the time-dependent structure that we focus, a naive simple PCA is not sufficent to extract such temporal structures from neural activities, since PCA is not specificall designed for incapsulating dynamical structures. Here Churchland et al. developed an algorithm called jPCA to reoslve this issue. Specifically, it finds orthonormal axes (thus basis which define linear subspaces) which capture the strongest rotational components from subspace identified by PCA (to ensure that the rotational dynamics come from subspaces that efficiently "represent" the high dimensional neural space). Conseuqently, this is equivalent to rotating the PCA projections to help us "see" the rotation most clearly (as shown in video below). In the paper the authors chose the PCA dimension as 6, and the data projected from the 6-D PCA space to the first 2 jPCA components, thus a plane which captures the strongest rotations, is displayed to reveal the underlying oscillatory structure. 

<div class="row mt-3">
    <div class="col-sm mt-3 mt-md-0">
        {% include video.liquid path="assets/video/jPCA/jPCA_Supp_Video_2.mp4" class="img-fluid rounded z-depth-1" controls=true autoplay=true %}
    </div>
</div>
<div class="caption">
    Adapted from Supplementary Movie 2 in {% cite jpca %}, showing jPCA projections are essentially a different view of PCA projections. 
</div>


## Discussions
The extracted neural trajectory is only "quasi-oscillatory", and usually exists for barely 1 cycle. 

For many neurons, the preparatory and movement-related single neuron responses do exhibit some quasi-oscillations which last for about 1 cycle (See in below).

<div class="row mt-3">
    <div class="col-sm mt-3 mt-md-0">
        {% include figure.liquid loading="eager" path="assets/img/jPCA/jPCA_fig_2.png" class="img-fluid rounded z-depth-1" zoomable=true %}
    </div>
</div>
<div class="caption">
    Adapted from Fig. 2 in {% cite jpca %}. Trace colors are according to the strengthof preparatory activities (red with greatest preparotory response). It allows clear view of the evolution of preparatory patterns during the movement. 
</div>

Not sure yet if this explains the observed rotation structure at the population level. However, the population level state-space rotations direcly to neural responses at single unit level: notice that each axis of jPCA exhibits similar patterns as single-neuron response(shown below)

<div class="row mt-3">
    <div class="col-sm mt-3 mt-md-0">
        {% include figure.liquid loading="eager" path="assets/img/jPCA/jPCA_supfig_1.png" class="img-fluid rounded z-depth-1" zoomable=true %}
    </div>
</div>
<div class="caption">
    Adapted from Supplementary Fig. 1 in {% cite jpca %}. The projections onto jPC's are similar to single neuron response. 
</div>

As Churchland et al argued, this could be explained by the fact that jPC's capture the most conscipuous patterns in the data, and each jPCA projection is a weighted sum/average of individual-neuron resopnses. Likewise, each single neuron could also be interpreted as a combination of all the jPC projected patterns, except that the intertwined relationship is not obvious if just viewed from a single neuron or a pattern itself. 





## Open Questions
What happens after the 200ms? As shown in Supp Movie 3 below, how would the observed rotations evolve later in time (notice that all the rotations exist for merely 1~1.5 cylces)

<div class="row mt-3">
    <div class="col-sm mt-3 mt-md-0">
        {% include video.liquid path="assets/video/jPCA/jPCA_Supp_Video_3.mp4" class="img-fluid rounded z-depth-1" controls=true autoplay=true %}
    </div>
</div>
<div class="caption">
    Adapted from Supplementary Movie 3 in {% cite jpca %}, showing the evolution of the projected states. 
</div>

Although in the Discussions section, I briefly talked about the reason for existence of the rotational structures, The problem remains as to how individual oscillations of different phases and amplitudes would result in a consistent rotation. 

At the algorithmic level, the jPCA method stems from dissecting the rotation component away from the general linear transformation. Can this be further stripped away from PCA? 


