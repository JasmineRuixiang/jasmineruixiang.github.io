---
layout: post
title: 'The Dance of Space: Geom/Topo/Dynam Mumble(6): Positive Semidefinite Matrix'
date: 2026-02-26 14:58:02
description: PSD, Riemannian/Information Geometry, Optimal Transport
tags: 
    - "Manifold"
    - "Differential Geometry"
categories: 
    - "Brain-Computer Interface"
featured: false
related_posts: true
related_publications: true
citation: true
math: true
toc:
  beginning: true
  sidebar: left
---

We've talked about the collection of positive definite matrices on several occasions already, each time focusing on different facets. On [the post]({% post_url 2026-02-23-Manifold(4)-Lie %}) on Lie group/algebra, 
I explained that it is not a Lie group but a smooth manifold, and then in [the later post]({% post_url 2026-02-24-Manifold(X)-metric %}), we saw that by introducing Riemannian metric we could turn 

$$
\mathrm{SPD}(n)
= \{ A \in \mathbb{R}^{n \times n} \mid A^\top = A,\; A > 0 \}.
$$

into a Riemannian manifold, upon which we could calculate distance and geodesics. Specifically, we spent sometime going over the computation of affine invariant distance:

$$
d(A,B)
= \left\|
\log\left(A^{-1/2} B A^{-1/2}\right)
\right\|_F = \left(
\sum_{i=1}^n (\log \lambda_i)^2
\right)^{1/2}.
$$

where $$\lambda_i$$ are eigenvalues of $$A^{-1}B$$. 

In this blog, I want to dive in a little deeper into this Riemannian manifold with the affine-invariant metric. 

One more time, to recall the geometry of $$\mathrm{SPD}(n)$$

Let

$$
\mathrm{SPD}(n)
= \{ A \in \mathbb{R}^{n\times n} \mid A^\top = A,\; A > 0 \}.
$$

This is a smooth manifold of dimension $$\frac{n(n+1)}{2}$$.

It can be identified with the symmetric space

$$
\mathrm{SPD}(n)
\cong
\mathrm{GL}(n)/\mathrm{O}(n).
$$

Let's start by figuring out where the affine-invariant metric comes from.  

---

## 1] Deriving the Affine-Invariant Metric from First Principles

We want a Riemannian metric satisfying the following properties:

1. Smoothness
2. Positive definiteness
3. Invariance under congruence transformations

$$
A \mapsto M A M^\top
\quad \text{for } M \in \mathrm{GL}(n).
$$

This invariance is the key principle. Sidenote: this is different from similarity transformation ($$A \mapsto M A M^{-1}
\quad \text{for } M \in \mathrm{GL}(n)$$).

Why do we need such invariance under congruence? Because SPD matrices represent quadratic forms.

If a quadratic form is $$q(x) = x^\top A x$$ and we change coordinates $$y = Mx$$, then $$q(y) = x^\top (M^\top A M) x$$. Up to swapping left/right order, this is exactly congruence.

Consequently, congruence encodes the change of coordinates for quadratic forms. And we want the metric to be invariance under such coordinate changes. 

On the other hand, it's not hard to show that SPD stay SPD under congruence. Why? Let $$A \in \mathrm{SPD}(n)$$. Then for any nonzero vector $$x$$,

$$
x^\top (M A M^\top) x
= (M^\top x)^\top A (M^\top x).
$$

Since $M^\top x \neq 0$ whenever $x \neq 0$,

So:

$$
M A M^\top \in \mathrm{SPD}(n).
$$

Thus $$\mathrm{SPD}(n)$$ is closed under congruence transformations.

---
Before we continue, it's worth clarifying what "affine-invariant metric" mean. We say the metric is `affine-invariant` if:

$$
d(A,B)
= d(M A M^\top,\; M B M^\top), \forall M \in GL(n)
$$

(should this be actually termed "congruence-invariant"? )

Meaning:

> Distance does not depend on the coordinate system.

that means if we reparameterize space (this is the underlying vector space of $$x, y$$, not the ambient space where $$\mathrm{SPD}(n)$$ lives) by any invertible linear map, such defined distances between SPD matrices will remain unchanged. This is one key property we want to acquire. 

Consequently, in some sense this is the “right” symmetry. Because SPD matrices encode:

- Inner products
- Covariance matrices
- Metrics on vector spaces

Changing basis of the underlying vector space

$$
v \mapsto M v
$$

should not change intrinsic geometry. So the natural symmetry group acting on SPD is:

$$
A \mapsto M A M^\top.
$$

This also explains why we do not use similarity invariance. Notice that similarity preserves eigenvalues (not proved here), whereas congruence preserves:

- Positive definiteness
- Inertia (Sylvester’s law)

But eigenvalues change under congruence. In other words, congruence corresponds to changing coordinates in the domain, not changing the linear operator as a map. $$\mathrm{SPD}$$ matrices are not being viewed as operators — they are being viewed as quadratic forms. This distinction is crucial.

Back to our goal. Now we are clear that we ideally require invariance under congruence. Notice that $$\mathrm{SPD}(n)$$ is an open subset of symmetric matrices, so at any point $$A \in \mathrm{SPD}(n)$$,

$$
T_A \mathrm{SPD}(n)
= \mathrm{Sym}(n),
$$

the space of symmetric matrices (I'll leave it to the readers for the proof). So tangent vectors are symmetric matrices $$H,K$$, and then our goal is to find $$g_A(H, K)$$ that depends smoothly on $$A \in \mathrm{SPD}(n)$$.

Because of invariance, it suffices to define the metric at $$I$$ (echoeing the definition of Lie derivative). Why? Any $$A \in \mathrm{SPD}(n)$$ can be sent to $$I$$ by congruence of $$A^{-1/2}$$. Thus, if we know the metric at $$I$$, invariance determines it everywhere.

Then, we want the metric at identity to be invariant under the stabilizer group: $$I \rightarrow QIQ^\top = I$$, where $$Q \in O(n)$$, so the metric must satisfy

$$
g_I(H,K) = g_I(QHQ^\top, QKQ^\top)
$$

What bilinear forms on symmetric matrices have this invariance? By representation theory (or symmetry reasoning) the only such inner product (up to scaling) is:

$$
g_I(H,K)
= \mathrm{tr}(HK).
$$

This is $\mathrm{O}(n)$-invariant (check it yourself) and there's no other alternative.

Finally, to transport this inner product using congruence, given $$A \in \mathrm{SPD}(n)$$, transport back to $$I$$ via:

$$
H \mapsto A^{-1/2} H A^{-1/2}.
$$

Consequently, we define:

$$
g_A(H,K)
= \mathrm{tr}\!\left(
A^{-1/2} H A^{-1} K A^{-1/2}
\right).
$$

Consequently, the final metric is of the form

$$
\boxed{
g_A(H,K)
= \mathrm{tr}(A^{-1} H A^{-1} K)
}
$$

This is indeed the **affine-invariant Riemannian metric** we saw above.

To prove that it's indeed a Riemannian metric, we need to prove that it varies smoothly over the input domain...

---


## 2] Distance and Geodesics
Using symmetry again, because the metric is affine-invariant, we can move $$A$$ to identity without changing distance. Define $$C = A^{-1/2}BA^{-1/2}$$, then

$$
d(A, B) = d(I, C)
$$

Consequently, we only need distance from identity, which we know specifically the metric, jus the Frobenius:

$$
g_I(H, K) = tr(HK)
$$

So near identity, the manifold looks Euclidean. Now consider the exponential curve (just matrix exponential for now, not apriori the exponential map per se):

$$
\gamma(t) = \exp(tX)
$$

which means 

$$
\dot{\gamma}(t) = \gamma(t)X
$$

We then compute its speed: 

$$
||\dot{\gamma}(t)||^2_{\gamma(t)} = tr(\gamma(t)^{-1}\dot{\gamma}(t)\gamma(t)^{-1}\dot{\gamma}(t))
$$

But since 

$$
\gamma^{-1}(t)\dot{\gamma}(t) = X
$$

we obtain that 

$$
||\dot{\gamma}(t)||^2_{\gamma(t)} = tr(X^2)
$$

which means the speed is constant, and that leads naturally to the fact that the exponential curves are geodesics.

From the above it's easy to deduce the geodesic from $$I$$ to any $$C \in \mathrm{SPD(n)}$$: Write $$C = Q\Lambda Q^\top$$, with eigenvalues $$\lambda_i > 0$$. Then define $$X = Q diag(log(\lambda_i)) Q^\top$$. Consequently $$C = exp(X)$$. So the geodesic from identity to $$C$$ is 

$$
\gamma(t) = exp(tX)
$$

Because it's constant speed from $$t = 0$$ to $$t = 1$$, the length of such geodesic is:

$$
\sqrt{tr(X^2)}
$$

Since $$X = Q diag(log(\lambda_i)) Q^\top$$, we obtain

$$
tr(X^2) = \sum_{1}^{n}log(\lambda_i)^2
$$

thus

$$
d(A, B)= \sqrt{\sum_{1}^{n}log(\lambda_i)^2}
$$

where $$\lambda_i$$ are eigenvalues of $$A^{-1}B$$. 

In short, what really happened here conceptually is that symmetry forced the metric, and the metric made the exponential map natural. Based on affine invariance, everything was reduced to identity at which the geometry is close to Euclidean. Logarithm linearizes multiplicative structure, so the geometry becomes Euclidean in log-eigenvalue coordinates.

[TODO] 

There's another way to look at the distance formula from above. 

The natural next step is to calculate the geodesics given such Riemannian metric. Solving the geodesic equation gives:

$$
\gamma(t)
= A^{1/2}
\left(
A^{-1/2} B A^{-1/2}
\right)^t
A^{1/2}.
$$

Distance:

$$
d(A,B)
= \left\|
\log(A^{-1/2} B A^{-1/2})
\right\|_F.
$$

If $\lambda_i$ are eigenvalues of $A^{-1}B$, then

$$
d(A,B)
= \left(
\sum_{i=1}^n (\log \lambda_i)^2
\right)^{1/2}.
$$

Please refer to [this blog]({% post_url 2026-02-24-Manifold(X)-metric %}) for deriving the distance formula based on eigenvalues. 

---

## 3] Bigger Picture
At this point you might be wondering why exactly exponential curves solve the geodesic equation. There are two complementary ways to understand why exponential curves are geodesics on $$\mathrm{SPD}(n)$$ under the affine-invariant metric:

1. **Lie–theoretic (symmetric space) argument**, which is conceptual and clean
2. **Direct Riemannian computation**, which is  explicit and concrete

The first one is conceptual and clean, whereas the second one is explicit and concrete. Moreover, the first viewpoint belies a more fundamental fact. Let's do both.

### 3.1] Symmetric space viewpoint 

Recall:

$$
\mathrm{SPD}(n) \cong \mathrm{GL}(n)/\mathrm{O}(n).
$$

This is a **Riemannian symmetric space**. [TODO]

Recall there is a general theorem:

> On a Riemannian symmetric space $$G/K$$, geodesics through the identity coset are exactly curves of the form
> $$
> \gamma(t) = \exp(tX) \cdot o,
> $$
> where $$X$$ lies in the symmetric part of the Lie algebra.

For $$\mathrm{SPD}(n)$$:

- Lie algebra of $\mathrm{GL}(n)$ = all matrices
- Decomposition:
  $$
  \mathfrak{gl}(n)
  = \mathfrak{o}(n) \oplus \mathrm{Sym}(n)
  $$
  (skew + symmetric)

The tangent space of $$\mathrm{SPD(n)}$$ at identity corresponds to **symmetric matrices**.

So geodesics through identity are:

$$
\gamma(t) = \exp(tX),
\quad X = X^\top.
$$

This is a structural result of symmetric space geometry. So exponentials are not guessed — they are forced by the homogeneous structure.

---

### 3.2] Riemannian computation
Now let’s verify it directly. Notice that the affine-invariant metric is:

$$
g_A(H,K)
= \mathrm{tr}(A^{-1} H A^{-1} K).
$$

We want curves $\gamma(t)$ minimizing energy:

$$
E = \frac12 \int
\mathrm{tr}
\big(
\gamma^{-1} \dot{\gamma}
\gamma^{-1} \dot{\gamma}
\big)
\, dt.
$$

Define the “velocity in body coordinates”:

$$
V(t)
= \gamma^{-1}(t)\dot{\gamma}(t).
$$

Then the energy becomes:

$$
E = \frac12 \int \mathrm{tr}(V^2) dt.
$$

Now vary the curve. The Euler–Lagrange equation gives:

$$
\dot{V} = 0.
$$

So:

$$
V(t) = X
$$

for some constant symmetric matrix $X$.

But $$V = \gamma^{-1} \dot{\gamma}$$, so we get:

$$
\gamma^{-1} \dot{\gamma} = X.
$$

Multiply both sides by $$\gamma$$:

$$
\dot{\gamma} = \gamma X.
$$

This is a matrix differential equation.

Solve it:

$$
\gamma(t) = \gamma(0)\exp(tX).
$$

That’s it. So exponential curves solve the geodesic equation because:

> The metric makes the energy depend only on $\gamma^{-1}\dot{\gamma}$, and minimizing energy forces that quantity to be constant.

---

### 3.3] Why does this happen geometrically?

This is the key geometric reason: the metric is **left-invariant under congruence action**.  When a metric has strong symmetry:

- Geodesics correspond to 1-parameter subgroups
- Motion with constant “Lie alge bra velocity” is straight

Here the straight line condition is:

$$
\gamma^{-1}\dot{\gamma} = \text{constant}.
$$

This is the nonlinear analogue of:

$$
\dot{x} = \text{constant}
$$

in Euclidean space.

---

### 3.4] Why symmetric $$X$$?

Because:

- Tangent space at identity = symmetric matrices
- If $$X$$ were skew-symmetric, $$\exp(tX)$$ would stay in $$\mathrm{O}(n)$$
- Symmetric $$X$$ keeps us inside SPD

Thus:

$$
X = X^\top.
$$

---

### 3.5] Intuition in log coordinates

Consider the map:

$$
A \mapsto \log A.
$$

Near identity:

$$
\gamma(t) = \exp(tX)
$$

becomes:

$$
\log \gamma(t) = tX.
$$

So in log-coordinates:

> Geodesics are straight lines.

That’s the cleanest intuition.

---

### 3.6] Big picture summary

Exponential curves solve the geodesic equation because:

1. SPD is a symmetric space.
2. The metric depends only on $$\gamma^{-1}\dot{\gamma}$$.
3. Minimizing energy forces that quantity to be constant.
4. Constant Lie algebra velocity integrates to exponentials.
5. Logarithm linearizes the geometry.

So exponentials are not magic — they are the nonlinear version of straight lines.


---

## 4] Why Curvature Is Negative

Recall:

$$
\mathrm{SPD}(n)
\cong
\mathrm{GL}(n)/\mathrm{O}(n).
$$

This is indeed a __noncompact__ Riemannian symmetric space.

Notice that we have a general theorem:

> If $$G/K$$ is noncompact semisimple, then sectional curvature is nonpositive.

Since $\mathrm{GL}(n)$ is noncompact and $\mathrm{O}(n)$ is compact,

$$
\mathrm{SPD}(n)
$$

has nonpositive sectional curvature.

The intuition for the above is that if we investigate using the logarithm map:

$$
A \mapsto \log A.
$$

Eigenvalues become:

$$
\lambda_i \mapsto \log \lambda_i.
$$

Distance becomes Euclidean in log-eigenvalue coordinates:

$$
d^2 = \sum (\log \lambda_i)^2.
$$

Logarithm turns multiplicative changes into additive ones. Consequently, multiplicative geometry is turned into hyperbolic-like geometry which entails negative curvature.

It's also true that in this case geodesics spread apart faster than Euclidean ones.


---

## 3] Exponential and Logarithmic Map



---

## 4] Connection to Wasserstein Distance

Consider zero-mean Gaussian measures:

$$
\mathcal{N}(0,A), \quad \mathcal{N}(0,B).
$$

Their 2-Wasserstein distance is:

$$
W_2^2(A,B)
= \mathrm{tr}(A) + \mathrm{tr}(B) - 2\,\mathrm{tr}
\left(
(A^{1/2} B A^{1/2})^{1/2}
\right).
$$

This induces the **Bures metric** on SPD.

If we do a direct comparison

Affine-invariant metric:

- Arises from group symmetry
- Negative curvature
- Multiplicative geodesics

Wasserstein/Bures metric:

- Arises from optimal transport
- Related to quantum information
- Different curvature structure

Both treat SPD matrices as a curved manifold, but from different geometric principles.

---

## 5] Connection to Fisher Information

Consider the family of Gaussians:

$$
p(x;A) = \frac{1}{(2\pi)^{n/2} \det(A)^{1/2}} \exp\left(-\frac12 x^\top A^{-1} x
\right).
$$

If we compute the Fisher information metric:

$$
g_A(H,K)
= \mathbb{E}
\left[
\partial_H \log p \;
\partial_K \log p
\right].
$$

One obtains:

$$
\boxed{ g_A(H,K)
= \frac12
\mathrm{tr}(A^{-1} H A^{-1} K)
}
$$

Up to a constant factor. Indeed, this is exactly the affine-invariant metric.

Consequently, this offers another interpretation of the affine-invariant metric as

- The Fisher information metric
- The natural gradient metric
- The intrinsic geometry of Gaussian covariance matrices

Thus:

> SPD geometry = Information geometry of Gaussians.

---

## 6] Summary

$$\mathrm{SPD}(n)$$ simultaneously appears as:

1. A symmetric space:
   $$
   \mathrm{GL}(n)/\mathrm{O}(n)
   $$

2. A negatively curved manifold under affine-invariant metric

3. The covariance manifold of Gaussians under Fisher metric

4. The state space of quantum density matrices under Bures metric

This is why it appears in optimal transport, information geometry, machine learning, and etc. 
